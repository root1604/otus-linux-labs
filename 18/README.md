# Домашнее задание 18
OSPF
- Поднять три виртуалки
- Объединить их разными private network
1. Поднять OSPF между машинами на базе Quagga
2. Изобразить ассиметричный роутинг
3. Сделать один из линков "дорогим", но что бы при этом роутинг был симметричным

## Решение
п.1-2 Настроим асимметричный роутинг по схеме
```
                               Схема сети
                               
        -----------------------------------------------------------
        |                                                         |
        |                 Router1                                 |     net-r1
        |         eth1             eth2               eth3        |---------------
        |  192.168.2.1/24         192.168.3.1/24   10.10.1.1/24   |   10.10.1.0/24
        |                                                         |
        -----------------------------------------------------------  
             /                               \
            / net-2 (cost 1000)               \ net-3 (cost 1)   
           /                                   \
---------------------------                    --------------------------
|           eth1          |                    |          eth1          |
|      192.168.2.2/24     |                    |     192.168.3.2/24     |
|                         |                    |                        |
|         Router2         |                    |         Router3        |
|                         |       net-4        |                        |
|           eth2          |--------------------|          eth2          |
|      192.168.4.2/24     |     (cost 100)     |     192.168.4.1/24     |
|                         |                    |                        |
|           eth3          |                    |           eth3         |
|        10.10.2.1/24     |                    |      10.10.3.1/24      |                                    
---------------------------                    --------------------------                                     
           |                                                 |
           |                                                 |
           |                                                 |
        net-r2                                             net-r3
    10.10.2.0/24                                        10.10.3.0/24
                    
```
Стенд разворачивается из [Vagrantfile](1/Vagrantfile)   
с помощью ролей ansible [router1.yml](1/router1.yml)  
[router2.yml](1/router2.yml)  
[router3.yml](1/router3.yml)   

Для проверки на запустим tcpdump на Router3
```
tcpdump -Xv -i eth1 icmp
tcpdump -Xv -i eth2 icmp  
```
и пропингуем 10.10.2.1  
трафик должен уходить с интерфейса eth1, а приходить на интерфейс eth2  

п.3 Настроим симметричный роутинг по схеме
```
                               Схема сети
                               
        -----------------------------------------------------------
        |                                                         |
        |                 Router1                                 |     net-r1
        |         eth1             eth2               eth3        |---------------
        |  192.168.2.1/24         192.168.3.1/24   10.10.1.1/24   |   10.10.1.0/24
        |                                                         |
        -----------------------------------------------------------  
             /                               \
            / net-2 (cost 1)                  \ net-3 (cost 1)   
           /                                   \
---------------------------                    --------------------------
|           eth1          |                    |          eth1          |
|      192.168.2.2/24     |                    |     192.168.3.2/24     |
|                         |                    |                        |
|         Router2         |                    |         Router3        |
|                         |       net-4        |                        |
|           eth2          |--------------------|          eth2          |
|      192.168.4.2/24     |     (cost 100)     |     192.168.4.1/24     |
|                         |                    |                        |
|           eth3          |                    |           eth3         |
|        10.10.2.1/24     |                    |      10.10.3.1/24      |                                    
---------------------------                    --------------------------                                     
           |                                                 |
           |                                                 |
           |                                                 |
        net-r2                                             net-r3
    10.10.2.0/24                                        10.10.3.0/24
                    
```

Запустим плейбук [symmetric.yml](2/symmetric.yml), который копирует файл ospfd.conf на Router2 командой  
```
ansible-playbook symmetric.yml -i .vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory
```
Для проверки на запустим tcpdump на Router3
```
tcpdump -Xv -i eth1 icmp
tcpdump -Xv -i eth2 icmp  
```
и пропингуем 10.10.2.1  
трафик должен уходить с интерфейса eth1 и приходить на интерфейс eth1

